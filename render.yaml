services:
  - type: web
    name: soapbox-server
    env: node
    plan: standard
    region: virginia
    repo: https://github.com/bluecollarsoapbox/soapbox-server
    branch: main
    buildCommand: npm ci
    startCommand: node server.js
    autoDeploy: true
    envVars:
      - key: NODE_ENV
        value: production
      - key: DATA_DIR
        value: /opt/render/project/data
      - key: PUBLIC_API_BASE
        value: https://soapbox-server.onrender.com
      - key: SPOTLIGHT_FEED_DIR
        value: /opt/render/project/data/Spotlights
      - key: STORIES_ROOT
        value: /opt/render/project/data/Stories
    disk:
      name: soapbox-data
      mountPath: /opt/render/project/data
      sizeGB: 1

  - type: worker
    name: soapbox-bot
    env: node
    plan: starter
    region: virginia
    repo: https://github.com/bluecollarsoapbox/soapbox-server
    branch: main
    buildCommand: npm ci
    startCommand: node bot.js
    autoDeploy: true
    envVars:
      - key: NODE_ENV
        value: production
      - key: DATA_DIR
        value: /opt/render/project/data
      - key: PUBLIC_API_BASE
        value: https://soapbox-server.onrender.com
      - key: SPOTLIGHT_FEED_DIR
        value: /opt/render/project/data/Spotlights
      - key: STORIES_ROOT
        value: /opt/render/project/data/Stories
    disk:
      name: soapbox-data
      mountPath: /opt/render/project/data
      sizeGB: 1
