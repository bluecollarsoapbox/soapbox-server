services:
  # ------------------ API (Express server.js) ------------------
  - type: web
    name: soapbox-server        # ðŸ‘ˆ API service name
    env: node
    plan: starter
    buildCommand: "npm install"
    startCommand: "node server.js"
    branch: main
    autoDeploy: true
    disk:
      name: soapbox-data
      mountPath: /opt/render/project/data
      sizeGB: 1
    envVars:
      - key: DATA_DIR
        value: /opt/render/project/data
      - key: STORIES_ROOT
        value: /opt/render/project/data/Stories
      - key: SPOTLIGHT_FEED_DIR
        value: /opt/render/project/data/Spotlights
      - key: CONFESSIONS_DIR
        value: /opt/render/project/data/Confessions
      - key: VOICEMAILS_DIR
        value: /opt/render/project/data/Voicemails For Discord

  # ------------------ Discord Bot (bot.js) ------------------
  - type: worker
    name: soapbox-bot           # ðŸ‘ˆ background worker for Discord bot
    env: node
    plan: starter
    buildCommand: "npm install"
    startCommand: "node bot.js"
    branch: main
    autoDeploy: true
    disk:
      name: soapbox-data
      mountPath: /opt/render/project/data
      sizeGB: 1
    envVars:
      - key: DATA_DIR
        value: /opt/render/project/data
      - key: STORIES_ROOT
        value: /opt/render/project/data/Stories
      - key: SPOTLIGHT_FEED_DIR
        value: /opt/render/project/data/Spotlights
      - key: CONFESSIONS_DIR
        value: /opt/render/project/data/Confessions
      - key: VOICEMAILS_DIR
        value: /opt/render/project/data/Voicemails For Discord
      - key: DISCORD_TOKEN       # ðŸ‘ˆ set in Render dashboard (secret)
        sync: false
      - key: SOAPBOX_API_KEY     # ðŸ‘ˆ set in Render dashboard (secret)
        sync: false
